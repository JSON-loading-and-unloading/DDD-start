<h1>도메인 모델과 바운디드 컨텍스트</h1>

<h2>도메인 모델과 경계</h2>

우리는 도메인을 완벽하게 표현하는 단일 모델을 만드는 시도를 하는 함정을 판다. </br>
![Unknown](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/0d1b833c-c2af-4dd1-b46d-8d4e7d4ff5b3)

카탈로그에서의 상품, 재고 관리에서의 상품, 주문에서 상품 등 카탈로그에서는 물리적으로 한 개인 상품이 재고 관리에서는
여러 개 존재할 수 있다.</br></br>

이처럼 하위 도메인마다 같은 용어라도 의미가 다르고 같은 대상이라도 지칭하는 용어가 다를 수 있기 때문에 한 개의
모델로 모든 하위 도메인을 표현하려는 시도는 올바른 방법이 아니며 표현할 수도 없다.</br>

모델은 특정한 컨텍스트 하에서 완전한 의미를 갖는다. 같은 제품이라도 카탈로그 컨텍스트와 재고 컨텍스트에서 의미가 서로다르다.</br>
이렇게 구분되는 경계를 갖는 컨텍스트를 DDD에서는 바운디드 컨텍스트라고 부른다.</br>


<h2>바운디드 컨텍스트</h2>

바운디드 컨텍스트는 모델의 경계를 결정하며 한 개의 바운디드 컨텍스트는 논리적으로 한 개의 모델을 갖는다.</br>
![Unknown-1](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/30cae73a-5ac9-49fd-88c0-04a6a11233d5)

위 그림에서의 바운디드 컨텍스트는 팀마다 다르다. </br>
![images](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/f3b14851-d8d2-48e7-9260-44c5ccb5afb1)

규모가 작을 경우</br>
하나의 바운디드 컨텍스트에서 여러가지로 나누기도 한다.</br>


<h2>바운디드 컨텍스트 구현</h2>


![Unknown-2](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/8baf7af8-cf71-46ca-a99c-65c6a0fa5b0d)


바운디드 컨텍스트에는 표현영역, 응용 서비스, 인프라스트럭처 영역을 모두 포함하고 있다.</br>
위 그림처럼 모든 바운디드 컨텍스트를 반드시 도메인 주도로 개발할 필요는 없다.</br>
상품의 리뷰는 복잡한 도메인 로직을 갖지 않기 때문에 CRUD 방식으로 구현해도 된다.</br></br>


한 바운디드 컨텍스트에서 두 방식을 혼합해서 사용할 수도 있다.</br>
예로  CQRS 패턴이다.</br>
각 바운디드 컨텍스트는 서로 다른 구현 기술을 사용할 수도 있다.</br>


<h2>바운디드 컨텍스트 간 통합</h2>

두 바운디드 컨텍스트끼리 협력을 하기 위해서는 </br>
1. 일반 api 통신(직접 통합)
2. 메시지 큐(간접 통합)

![images](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/160f5aef-c32a-4f70-9dbd-f4b188f57cca)


1. api를 통해 바운디드 컨텍스트에서 요청을 보낼 때, 인프라스트럭처에서 요청을 보내 정보를 가져온다.</br>
2. 메시지큐를 이용할 때, 필요로 하는 정보 요청을 메시지 큐에 추가한다.</br>

   ※메시지 큐는 비동기로 메시지를 처리하기 때문에 카탈로그 바운디드 컨텍스트는 메시지를 큐에 추가한 뒤에 추천 바운디드 컨텍스트가 메시지를 처리할 때까지 기다리지 않고 바로 이어서 자신의 처리를 계속한다.</br>


<h2>바운디드 컨텍스트 간 관계</h2>

서비스를 제공하는 바운디드 컨텍스트를 상류, 제공받는 바운디드 컨텍스트는 하류라고 한다.</br>

![download](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/6912065a-4b03-42c4-a271-69ac964e0cee)

만약 하류 팀이 다수로 존재하면 상류팀은 여러 하류 팀의 요구사항을 수용할 수 있는 api를 만들고 이를 서비스 형태로 공개해서 서비스의 일관성을 유지할 수 있다. 이를 공개 호스트 서비스라고 한다.</br></br>


※따라서 하류 컴포넌트는 사율 서비스의 모델이 자신의 도메인 모델에 영향을 주지 않도록 보호해 주는 완충 지대를 만들어야 한다.</br>
※두 바운디드 컨텍스트가 같은 모델을 공유할 수 있는데 이를 공유 커널이라고 한다. 독립적으로 분리할 수 있긴한데 서비스가 커질수록 복잡해져 결국 통합하게 되므로 공유 커널 형식을 지향하자.</br>

<h2>컨텍스트 맵</h2>

![images](https://github.com/JSON-loading-and-unloading/DDD-start/assets/106163272/86316e51-2b6e-4bd7-a22e-5898c48b5011)

컨텍스트 관계를 한 번에 보기 위해서 맵을 그려보는 것도 추천한다.</br>
HOS: 공급자</br>
ACL: 요청자</br>

